# XT_CaseInfo

X-Ways X-Tension to get info about evidence objects and users for your report.

## Requirements and Installation

This extension is compatible with **X-Ways (x64) v20.3 or higher**.

The Tools folder contains scripts (Regripper and Impacket) that are often detected and deleted by anti-virus software.

* **DOWNLOAD THE APP IN [RELEASES](https://github.com/kezzier/XT_CaseInfo/releases)**

* Install python and add it to %PATH%
* Add the contents of the _Tools_ folder to (your whitelisted folder) **\<your X-Ways installation directory>\XTensions\Tools\\**
* Prepare the assemblies needed for the X-Tension:

    Run _RUN_ME_FIRST.ps1_ in **Powershell as administrator**, in the **same directory as the assemblies folder**. (Use <code>& ./RUN_ME_FIRST.ps1</code> if running in Powershell ISE.)
    If you get the error that Powershell is unable to execute scripts, run the cmdlet <code>Set-ExecutionPolicy Unrestricted</code> first.
    If no error has occurred during execution of the script, it and the assemblies folder may be deleted.

* Add the X-Tension in X-Ways:
  1. In X-Ways, go to X-Tensions (cogwheel)
  2. Click the "+" button
  3. Reference the XT_CaseInfo dll
  4. When prompted for a 'force unload', choose "No" 

## Usage
The X-Tension can only be initialized from a __Refine Volume Snapshot__.

1. Open the RVS selection window
2. Check 'Run X-Tensions...'
3. Select the XT_CaseInfo dll
4. If you want a list of Windows (domain) users and their hashes, make sure to include the volume with the SAM, SYSTEM, and SECURITY registries
5. Run the RVS

Do not select any separate directories to run RVS for, only images/disks.

You will be prompted to enter a __filename (+ path)__ for the output generated by the X-Tension. If you want to use the default, click Cancel. The default file is _casename_\_json.txt on the current user's desktop. If you enter a filename but no path, the file is stored in the same directory as the CaseInfo dll.

## ReportAutomator
The [ReportAutomator](https://github.com/kezzier/ReportAutomator) script allows you to fill a report template with the JSON data returned by this X-Tension.
This script can be integrated into the X-Tension if the code is commented out in the solution and the script is placed in **\<your X-Ways installation directory>\XTensions\Tools\\**. Multiple languages can be supported. If you don't want to generate a report, click Cancel. The resulting file can be found in the same place as the json file and with the same naming convention.

## Result
The resulting JSON string is shown in the X-Ways message output and saved to a file.

_Info_: If a volume was added to the case separately from its disk, the X-Tension will add it to the case partitions.

_Info_: If this X-Tension is run on a live hard disk, any users found will be added to the case users.

_Info_: No users will be extracted from backups/SVC in an image. If you want those, you'll have to add the backup separately to the case.

The case output structure is the same as the following example:

```json
 {
    "Title":"BottomDisk",
    "Disks":[  
      {
         "Name":"d297e2b2-d433-11e6-bcbe-806e6f6e6963",  
         "Size":"234 GB", 
         "Partitions":[
            {
               "Name":"Partition 1",  
               "Label":"unknown",  
               "Type":"NTFS",  
               "Size":"234 GB",  
               "Free":"60%",  
               "FirstSector":"128",  
               "OS":"Windows 10 Home",  
               "ComputerName":"my computer", 
               "Timezone":"Romance Standard Time",  
               "Installation":"01/01/1601",  
               "Shutdown":"07/01/2017",    
               "LabelDate":"18/05/2013",
               "Owner":"User1", 
               "NoUsers": 2,
               "Users":[
                  {
                     "Domain": "local",
                     "SID":"S-1-5-21-2767594208-1392015090-2400965544-500",  
                     "Username":"Administrator",  
                     "FullName":"unknown",
                     "InternetName": "unknown",  
                     "Comment":"Built-in account for administering the computer/domain",  
                     "LastLogin":"14/07/2009",  
                     "Hash":"31d6cfe0d16ae931b73c59d7e0c089c0",
                     "HashType":"ntlm",
                     "PwdHint": "unknown",
                     "IsInactive": false  
                  },  
                  {
                     "Domain": "local",
                     "SID":"S-1-5-21-2767594208-1392015090-2400965544-501",  
                     "Username":"Guest",  
                     "FullName":"unknown",
                     "InternetName": "unknown",    
                     "Comment":"Built-in account for guest access to the computer/domain",  
                     "LastLogin":"30/08/2014",  
                     "Hash":"31d6cfe0d16ae931b73c59d7e0c089c0",
                     "HashType":"ntlm",
                     "PwdHint": "unknown",
                     "IsInactive": false   
                  }
               ],
               "Volumes": [
                  {
                     "Label": "macOS Catalina - Data",
                     "Creation": "01/03/2020",
                     "LastWrite": "20/04/2020"
                  },
                  {
                     "Label": "Preboot",
                     "Creation": "01/03/2020",
                     "LastWrite": "20/04/2020"
                  }
               ]
            },  
            {
               "Name":"hiberfil 2.sys",  
               "Label":"unknown",  
               "Type":"Unknown",  
               "Size":"1,1 GB",  
               "Free":"unknown",  
               "FirstSector":"unknown",  
               "OS":"unknown",  
               "ComputerName":"unknown",
               "Timezone":"unknown",  
               "Installation":"unknown",  
               "Shutdown":"unknown",     
               "LabelDate":"18/05/2013",
               "Owner":"unknown",  
               "NoUsers": 0,
               "Users": []  
            }  
         ] 
      }  
    ],  
    "Partitions":[
      {
         "Name":"6L250R0_BottomDisk",  
         "Label":"unknown",  
         "Type":"NTFS",  
         "Size":"234 GB",  
         "Free":"60%",  
         "FirstSector":"43",  
         "OS":"Windows 7 Enterprise",  
         "ComputerName":"Home-PC",
         "Timezone":"Romance Standard Time",  
         "Installation":"06/01/2017",  
         "Shutdown":"19/07/2019",     
         "LabelDate":"18/05/2017",
         "Owner":"Me",  
         "NoUsers": 0,
         "Users": []   
      }
    ], 
    "NoUsers":0,
    "Users":[],
    "General":{
       "XWaysVersion":"20.1",
       "DllVersion":"3.1.1.0"
    }
}
```
